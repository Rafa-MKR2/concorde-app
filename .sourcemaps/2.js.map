{"version":3,"sources":["../../src/pages/home/home.module.ts","../../node_modules/rxjs/add/operator/do.js","../../src/pages/chat/chat.ts","../../node_modules/rxjs-compat/add/operator/do.js","../../node_modules/rxjs-compat/operator/do.js","../../src/pages/home/home.ts","../../node_modules/rxjs/add/operator/map.js","../../node_modules/rxjs-compat/add/operator/map.js","../../node_modules/rxjs-compat/operator/map.js"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["/**\n * Created by hsuanlee on 2017/4/4.\n */\nimport { NgModule} from '@angular/core';\nimport { HomePage} from './home';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n    declarations: [HomePage],\n    imports: [\n        IonicPageModule.forChild(HomePage),\n\n    ],\n})\nexport class HomePageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.module.ts","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"rxjs-compat/add/operator/do\");\n//# sourceMappingURL=do.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs/add/operator/do.js\n// module id = 596\n// module chunks = 0 1 2","import { Component, ElementRef, ViewChild } from '@angular/core';\nimport { IonicPage, NavParams } from 'ionic-angular';\nimport { Events, Content } from 'ionic-angular';\nimport { ChatService, ChatMessage, UserInfo, Inbox } from \"../../providers/chat-service\";\n\nimport 'rxjs/add/operator/do';\nimport * as firebase from 'firebase';\nimport { FirebaseDatabase } from '@angular/fire';\nimport { AngularFireAuth } from '@angular/fire/auth';\n\n@IonicPage()\n@Component({\n  selector: 'page-chat',\n  templateUrl: 'chat.html',\n})\nexport class Chat {\n\n  @ViewChild(Content) content: Content;\n  @ViewChild('chat_input') messageInput: ElementRef;\n  msgList: ChatMessage[] =[];\n  user: UserInfo;\n  toUser: UserInfo;\n  editorMsg = '';\n  showEmojiPicker = false;\n\n  inbox: Inbox;\n  digitando: Boolean =false;\n\n  private db:FirebaseDatabase =  firebase.database();\n\n  constructor(public navParams: NavParams,\n              private auth : AngularFireAuth,\n              private chatService: ChatService,\n              private events: Events) {\n\n\n       \n    \n \n    // informação do contato\n    this.toUser = {\n      id: navParams.get('toUserId'),\n      name: navParams.get('toUserName'),\n    avatar: navParams.get('toUserAvatar')\n \n    };\n    // informações do usuario\n  \n  this.user = {\n      id:this.auth.auth.currentUser.uid,\n      name: this.auth.auth.currentUser.displayName,\n      avatar: this.auth.auth.currentUser.photoURL\n    }\n\n    this.db.ref('inbox/'+this.toUser.id+'-'+this.user.id).on('child_changed',snap => {\n      console.log(snap.val())\n      this.digitando = snap.val();\n      if(this.content._scroll) this.content.scrollToBottom(0);\n\n    })\n  }\n\n  teste(e){\n    if(e){  \n      this.chatService.update('inbox/'+this.user.id+'-'+this.toUser.id,{ digitando:true})\n  \n    }else{\n      this.chatService.update('inbox/'+this.user.id+'-'+this.toUser.id,{ digitando:false})\n    }\n    if(this.content._scroll) this.content.scrollToBottom(0);\n\n\n  }\n\n  ionViewWillLeave() {\n    // unsubscribe\n    this.editorMsg = '';\n    if(this.content._scroll) this.content.scrollToBottom(0);\n    this.events.unsubscribe('chat:received');\n    this.chatService.update('inbox/'+this.user.id+'-'+this.toUser.id,{ digitando:false})\n\n \n  }\n\n  ionViewDidEnter() {\n    this.getMsgList()\n    this.scrollToBottom();\n    this.content.scrollToBottom(0);\n    this.chatService.update('inbox/'+this.user.id+'-'+this.toUser.id,{\n      digitando:false\n    })\n  \n  }\n\n  onFocus() {\n    this.showEmojiPicker = false;\n    this.content.resize();\n    this.scrollToBottom();\n  }\n\n  switchEmojiPicker() {\n    this.showEmojiPicker = !this.showEmojiPicker;\n    if (!this.showEmojiPicker) {\n      this.focus();\n    } else {\n      this.setTextareaScroll();\n    }\n    this.content.resize();\n    this.scrollToBottom();\n  }\n\n \n\n  getMsgList(){\n    const userId = this.user.id,\n    toUserId = this.toUser.id;\n    \n       this.chatService.getAll('mensagens/').subscribe(lista => \n       lista.forEach(item=>{\n       let obj:any = item.payload.val(),\n        msg:ChatMessage = obj,\n        target = this.getMsgIndexById(obj.time)\n\n       if(target !== -1) return\n       else\n         if(msg.messageId===userId+toUserId ||\n            msg.messageId===toUserId+userId){\n              this.msgList.push(obj)\n\n            }\n       }))\n   }\n \n\n \n\n\n  sendMsg() {\n    if (!this.editorMsg.trim()) return;\n\n    // Mensagem\n    let newMsg: ChatMessage = {\n      messageId:this.user.id+this.toUser.id,\n      userId: this.user.id,\n      userName: this.user.name,\n      userAvatar: this.user.avatar,\n      toUserId: this.toUser.id,\n      time: Date.now(),\n      message: this.editorMsg,\n      status: 'pending'\n    };\n\n    this.pushNewMsg(newMsg);\n    this.editorMsg = '';\n\n    if(!this.showEmojiPicker) {\n      this.focus();\n    }\n\n    this.chatService.sendMsg(newMsg)\n    .then(() => {\n        newMsg.status = 'success';\n        this.chatService.save('mensagens/',newMsg)\n        this.teste('')\n        this.getMsgList()\n        this.scrollToBottom()\n\n    })\n  }\n\n\n  pushNewMsg(msg: ChatMessage) {\n\n    const userId = this.user.id,\n      toUserId = this.toUser.id;\n    // verifica ordem das mensagens\n    if(msg.userId === userId && msg.toUserId === toUserId) {\n      this.msgList.push(msg);\n\n    } else if(msg.toUserId === userId && msg.userId === toUserId) {\n      this.msgList.push(msg);\n    }\n    this.scrollToBottom()\n\n  }\n\n \n\n  scrollToBottom() {\n      if (this.content.scrollToBottom) {\n       return this.content.scrollToBottom();\n\n      }\n\n  }\n\n\n\n\n\n  private focus() {\n    if (this.messageInput && this.messageInput.nativeElement) {\n      this.messageInput.nativeElement.focus();\n    }  \n  }\n\n  private getMsgIndexById(target: string) {\n    return this.msgList.findIndex(e => e.time === target)\n  }\n\n  private setTextareaScroll() {\n    const textarea =this.messageInput.nativeElement;\n    textarea.scrollTop = textarea.scrollHeight;\n  }\n\n  \n  public dateConvert(time: number){\n    let date = new Date(time),\n        hours = date.getHours()<10? '0'+date.getHours(): date.getHours(),\n        minutes = date.getMinutes()<10? '0'+date.getMinutes():date.getMinutes();\n\n    return  hours+':'+minutes;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.ts","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar rxjs_1 = require(\"rxjs\");\nvar do_1 = require(\"../../operator/do\");\nrxjs_1.Observable.prototype.do = do_1._do;\nrxjs_1.Observable.prototype._do = do_1._do;\n//# sourceMappingURL=do.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs-compat/add/operator/do.js\n// module id = 600\n// module chunks = 0 1 2","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar operators_1 = require(\"rxjs/operators\");\n/* tslint:enable:max-line-length */\n/**\n * Perform a side effect for every emission on the source Observable, but return\n * an Observable that is identical to the source.\n *\n * <span class=\"informal\">Intercepts each emission on the source and runs a\n * function, but returns an output which is identical to the source as long as errors don't occur.</span>\n *\n * <img src=\"./img/do.png\" width=\"100%\">\n *\n * Returns a mirrored Observable of the source Observable, but modified so that\n * the provided Observer is called to perform a side effect for every value,\n * error, and completion emitted by the source. Any errors that are thrown in\n * the aforementioned Observer or handlers are safely sent down the error path\n * of the output Observable.\n *\n * This operator is useful for debugging your Observables for the correct values\n * or performing other side effects.\n *\n * Note: this is different to a `subscribe` on the Observable. If the Observable\n * returned by `do` is not subscribed, the side effects specified by the\n * Observer will never happen. `do` therefore simply spies on existing\n * execution, it does not trigger an execution to happen like `subscribe` does.\n *\n * @example <caption>Map every click to the clientX position of that click, while also logging the click event</caption>\n * var clicks = Rx.Observable.fromEvent(document, 'click');\n * var positions = clicks\n *   .do(ev => console.log(ev))\n *   .map(ev => ev.clientX);\n * positions.subscribe(x => console.log(x));\n *\n * @see {@link map}\n * @see {@link subscribe}\n *\n * @param {Observer|function} [nextOrObserver] A normal Observer object or a\n * callback for `next`.\n * @param {function} [error] Callback for errors in the source.\n * @param {function} [complete] Callback for the completion of the source.\n * @return {Observable} An Observable identical to the source, but runs the\n * specified Observer or callback(s) for each item.\n * @method do\n * @name do\n * @owner Observable\n */\nfunction _do(nextOrObserver, error, complete) {\n    return operators_1.tap(nextOrObserver, error, complete)(this);\n}\nexports._do = _do;\n//# sourceMappingURL=do.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs-compat/operator/do.js\n// module id = 601\n// module chunks = 0 1 2","import { Component } from '@angular/core';\nimport { IonicPage, NavParams, App, Events } from 'ionic-angular';\nimport { ChatService,Contatos } from '../../providers/chat-service';\nimport { Observable } from 'rxjs';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFireDatabase } from '@angular/fire/database/database';\nimport { Chat } from '../chat/chat';\n \n\nimport 'rxjs/add/operator/do';\nimport 'rxjs/add/operator/map';\n\nimport * as firebase from 'firebase/app';\n\n\n@IonicPage()\n@Component({\n  selector: 'page-home',\n  templateUrl: 'home.html'\n})\nexport class HomePage {\n\n\n  public  usuarios: Observable<any>;\n  public  user = this.auth.auth.currentUser;\n  userId: string; // current user uid\n\n  constructor(public navParams: NavParams,\n              public auth : AngularFireAuth,\n              public db : AngularFireDatabase,\n              public app : App,\n              public events: Events,\n              private service: ChatService) {\n\n   this.listaContatos()\n    this.usuarios.forEach(e=> e.map(indice=>{\n      if(indice.id === this.user.uid) this.statusUpdate(indice.key);\n    })) \n\n  } \n\n  ionViewWillLeave(){\n  }\n\n\n  listaContatos(){\n  return  this.usuarios = this.service.getAll('usuarios').map(changes => {\n    return changes.map(c => ({ key: c.payload.key, ...c.payload.val() }));\n  })\n }\n \n\n statusUpdate(id: string){\n  this.userId =id;\n  /// Subscribe to auth state in firebase\n return this.auth.authState\n  .do(user => {\n    if (user) {\n      \n       this.updateOnConnect()     \n    }\n\n  })\n.pipe()\n.subscribe();\n }\n\nchat(contats: Contatos){\n  this.app.getRootNav().push(Chat.name,\n    {\n      toUserId:contats.id, \n      toUserName:contats.nome,\n      toUserAvatar: contats.photo\n    \n    })  \n}\n\n\n/// Helper to perform the update in Firebase\nprivate updateStatus(status: string) {\nif (!this.userId) return\n\nthis.db.object('usuarios/' + this.userId).update({ status: status })\nthis.updateOnDisconnect()\n\n}\n  \n\n/// Updates status when connection to Firebase starts\n updateOnConnect() {\nreturn this.db.object('.info/connected').valueChanges()\n         .do(connected => {\n             let status = connected ? 'online' : 'offline'\n             this.updateStatus(status)\n         })\n         .subscribe()\n} \n\n\n /// Updates status when connection to Firebase ends\n private updateOnDisconnect() {\n  firebase.database().ref().child('usuarios/'+this.userId)\n          .onDisconnect()\n          .update({status: 'offline'})\n} \n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"rxjs-compat/add/operator/map\");\n//# sourceMappingURL=map.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs/add/operator/map.js\n// module id = 604\n// module chunks = 1 2","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar rxjs_1 = require(\"rxjs\");\nvar map_1 = require(\"../../operator/map\");\nrxjs_1.Observable.prototype.map = map_1.map;\n//# sourceMappingURL=map.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs-compat/add/operator/map.js\n// module id = 605\n// module chunks = 1 2","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar operators_1 = require(\"rxjs/operators\");\n/**\n * Applies a given `project` function to each value emitted by the source\n * Observable, and emits the resulting values as an Observable.\n *\n * <span class=\"informal\">Like [Array.prototype.map()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map),\n * it passes each source value through a transformation function to get\n * corresponding output values.</span>\n *\n * <img src=\"./img/map.png\" width=\"100%\">\n *\n * Similar to the well known `Array.prototype.map` function, this operator\n * applies a projection to each value and emits that projection in the output\n * Observable.\n *\n * @example <caption>Map every click to the clientX position of that click</caption>\n * var clicks = Rx.Observable.fromEvent(document, 'click');\n * var positions = clicks.map(ev => ev.clientX);\n * positions.subscribe(x => console.log(x));\n *\n * @see {@link mapTo}\n * @see {@link pluck}\n *\n * @param {function(value: T, index: number): R} project The function to apply\n * to each `value` emitted by the source Observable. The `index` parameter is\n * the number `i` for the i-th emission that has happened since the\n * subscription, starting from the number `0`.\n * @param {any} [thisArg] An optional argument to define what `this` is in the\n * `project` function.\n * @return {Observable<R>} An Observable that emits the values from the source\n * Observable transformed by the given `project` function.\n * @method map\n * @owner Observable\n */\nfunction map(project, thisArg) {\n    return operators_1.map(project, thisArg)(this);\n}\nexports.map = map;\n//# sourceMappingURL=map.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs-compat/operator/map.js\n// module id = 606\n// module chunks = 1 2"],"sourceRoot":""}